<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta Data -->
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title> Live Streaming </title>
    <meta name="Description"  content="" />
    <meta name="Author" content="Smarts ElWady">
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<meta property="og:title" content="Live Streaming"/>
	<meta property="og:description" content="" />
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8380185804726759"
     crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://fonts.cdnfonts.com/css/neo-sans-arabic">
    <link rel="stylesheet" href="js/my_style.css">
	
	<!-- NoSleep.js for preventing screen sleep during video playback -->
	<script src="https://unpkg.com/nosleep.js@0.12.0/dist/NoSleep.min.js"></script>
	
	<style>
		h3{
			color:red;
			text-align:center;
		}
	</style>
</head>
<body style="width:100%; text-align:center; margin:0 auto;">
	<br/><br/>
	<a href="https://apps.apple.com/app/id6755069359">
			<img src="assets/down.png" style="width:300px;" />
	</a>
	<div id="Ad_3" style="width:100%; text-align:center; margin:0 auto;">
		<script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
		<script>
			  window.googletag = window.googletag || {cmd: []};
			  googletag.cmd.push(function() {
				googletag
					.defineSlot(
						'/39382643/ads1', [400, 300], 'banner-ad')
					.addService(googletag.pubads());
				googletag.enableServices();
			  });
		</script>
		<div style="min-height:280px; width:100%; padding-top: 10px; overflow: hidden; text-align:center; ">
			<div id="banner-ad">
				  <script>
					googletag.cmd.push(function() {
					  googletag.display('banner-ad');
					});
				  </script>
			</div>						
		</div>	
	</div>
	<br/>
	<div class="tab-content" style="max-width:500px; text-align:center; margin:0 auto;"></div>
	<script>
			// Initialize NoSleep
			let noSleep = new NoSleep();
			let isNoSleepEnabled = false;
			
			const params = new URLSearchParams(window.location.search);
			const id = params.get('id');
			const match = params.get('match');
			const token = params.get('token');
			
			// Function to enable/disable NoSleep
			function toggleNoSleep() {
				if (!isNoSleepEnabled) {
					// Enable wake lock
					noSleep.enable();
					isNoSleepEnabled = true;
					console.log("NoSleep enabled - screen will stay awake");
				} else {
					// Disable wake lock
					noSleep.disable();
					isNoSleepEnabled = false;
					console.log("NoSleep disabled");
				}
			}
			
			// Function to automatically enable NoSleep when video is playing
			function setupNoSleepForVideo() {
				// Wait for video elements to be added to the DOM
				setTimeout(function() {
					const videos = document.querySelectorAll('video');
					
					videos.forEach(function(video) {
						// Enable NoSleep when video starts playing
						video.addEventListener('play', function() {
							if (!isNoSleepEnabled) {
								noSleep.enable();
								isNoSleepEnabled = true;
								console.log("Video playing - NoSleep enabled");
							}
						});
						
						// Optionally disable NoSleep when video is paused
						video.addEventListener('pause', function() {
							if (isNoSleepEnabled) {
								noSleep.disable();
								isNoSleepEnabled = false;
								console.log("Video paused - NoSleep disabled");
							}
						});
						
						// Disable NoSleep when video ends
						video.addEventListener('ended', function() {
							if (isNoSleepEnabled) {
								noSleep.disable();
								isNoSleepEnabled = false;
								console.log("Video ended - NoSleep disabled");
							}
						});
					});
					
					// Also check for iframes that might contain video players
					const iframes = document.querySelectorAll('iframe');
					iframes.forEach(function(iframe) {
						try {
							iframe.addEventListener('load', function() {
								console.log("Iframe loaded - NoSleep ready");
							});
						} catch(e) {
							// Cross-origin iframe restrictions
						}
					});
				}, 2000); // Wait 2 seconds for content to load
			}
			
			// Add a button to manually toggle NoSleep (optional)
			function addNoSleepToggleButton() {
				const toggleBtn = document.createElement('button');
				toggleBtn.innerHTML = 'üîÜ Stay Awake: OFF';
				toggleBtn.style.cssText = 'position: fixed; bottom: 20px; right: 20px; z-index: 9999; padding: 10px; background: #333; color: white; border: none; border-radius: 5px; cursor: pointer;';
				toggleBtn.onclick = function() {
					toggleNoSleep();
					this.innerHTML = isNoSleepEnabled ? 'üîÜ Stay Awake: ON' : 'üîÜ Stay Awake: OFF';
				};
				document.body.appendChild(toggleBtn);
			}
			
			// Initialize when page loads
			document.addEventListener('DOMContentLoaded', function() {
				// Option 1: Auto-enable NoSleep (uncomment if you want it always on)
				// noSleep.enable();
				// isNoSleepEnabled = true;
				
				// Option 2: Add toggle button (uncomment if you want manual control)
				// addNoSleepToggleButton();
				
				// Option 3: Auto-detect and handle video (recommended)
				setupNoSleepForVideo();
			});
			
			//document.write('<a href="multi_ar.html?match_id='+match+'" class="myButton" type="button">ÿ≥Ÿäÿ±ŸÅÿ±ÿßÿ™ ÿ£ÿÆÿ±Ÿä</a>');

			$.ajax({
			  type: 'GET',
			  url: 'https://smartdb.smartselwady.org/LiveStreamCh2_View',
			  dataType: 'json'
			}).then(function(res) {
				//alert(JSON.stringify(res.results[0]));

			  var data = res.results[0].fetchDB;
			  var fetchDB = JSON.parse(data)
			  for (var i = 0; i < data.length; i++) {
				if(fetchDB[i].id == id){
						var codeValue = fetchDB[i].code_3;
						var code = codeValue.replace(/&amp;/g, '&')
                                .replace(/&quot;/g, '"')
                                .replace(/&#39;/g, "'")
                                .replace(/&lt;/g, '<')
                                .replace(/&gt;/g,¬†'>');
						$('.tab-content').html(code);
						
						// Setup NoSleep for the newly added video content
						setTimeout(setupNoSleepForVideo, 500);
						
						var Ch = fetchDB[i].channel_name_en;
						var Ch_N = Ch.replace(/ /g, '_')
						if (localStorage.getItem('DeviceUDID') == null ) {
							const rand=()=>Math.random(0).toString(36).substr(2);
							const token=(length)=>(rand()+rand()+rand()+rand()).substr(0,length);
							localStorage.setItem('DeviceUDID', token(40));
						}
						$.ajax({ url: "https://www.google-analytics.com/g/collect?v=2&tid=G-LFSG3FTWF4&gtm=45je49b0v9194873941za200&_p=1726238694775&gcd=13l3l3l3l1l1&npa=0&dma=0&tag_exp=0&_fid=dClwYdJTDoxegJlsXpE1cS&cid="+localStorage.getItem('DeviceUDID')+"&ul=&sr=&uaa=&uab=&uafvl=&uamb=0&uam=&uap=&uapv=&uaw=0&are=1&frm=0&pscdl=noapi&_s=1&sid="+localStorage.getItem('DeviceUDID')+"&sct=1&seg=1&dl=&dt="+Ch_N+"&en=page_view&_ee=1",success: function (e) {	} });	 

					return false;
				}
			  }
			});
			
			function isMobileDevice() {
				return (/Android|REDLINECLIENT|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));
			}
			if (!isMobileDevice()) {
				//window.location.href = 'https://alahly-eg.com'; // redirect to another website
			}
			
			// Clean up NoSleep when page is unloading
			window.addEventListener('beforeunload', function() {
				if (isNoSleepEnabled) {
					noSleep.disable();
				}
			});
	</script>
</body>
</html>